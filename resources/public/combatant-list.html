<link rel="import" href="components/polymer/polymer.html">
<link rel="import" href="combatant-card.html">
<link rel="import" href="x-websocket.html">

<polymer-element name="combatant-list" attributes="combatants show">
  <template>
    <style>
    :host {
      display: block;
      width: 100%;
    }
    combatant-card {
      margin-top: 30px;
    }
    </style>

	
	<div layout vertical center>
	
	  <input type="text" value="{{combatantName}}" hidden?="{{show != 'add-combatant'}}"> <button on-click="{{addCombatant}}"  hidden?="{{show != 'add-combatant'}}">Add Combatant</button>

	  <template repeat="{{combatant in combatants}}">
		<combatant-card 
		selected="{{combatant.selected}}"
		  show="{{show}}"
		  combatantName="{{combatant.combatantName}}"
		  hidden?="{{show == 'initiative' && !combatant.selected}}">
		  {{combatant.combatantName}}
		</combatant-card>
	  </template>

	</div>
	
  </template>

  <script>
  Polymer({
   publish: {
		show: {
			value: "add-combatant",
			reflect: true
		}
	  },
  created: function() {
      this.combatants = [];
    },
	addCombatant: function() {
		var addCombatantData = { data: { combatantName: this.combatantName}, eventName: "add-combatant" };
		var xws = document.querySelector("x-websocket");
		xws.send(addCombatantData);
		this.combatantName = '';
	  }
	});
  </script>

</polymer-element>
